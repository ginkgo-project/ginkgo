<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ginkgo: Installation Instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_doc.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ginkgo
   &#160;<span id="projectnumber">Generated from pipelines/95721987 branch based on develop. Ginkgo version 1.1.0</span>
   </div>
   <div id="projectbrief">A numerical linear algebra library targeting many-core architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Installation Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md0"></a>
Building</h2>
<p>Use the standard cmake build procedure:</p>
<div class="fragment"><div class="line">mkdir build; cd build</div>
<div class="line">cmake -G &quot;Unix Makefiles&quot; [OPTIONS] .. &amp;&amp; make</div>
</div><!-- fragment --><p> Use <code>cmake --build .</code> in some systems like MinGW or Microsoft Visual Studio which do not use <code>make</code>.</p>
<p>For Microsoft Visual Studio, use <code>cmake --build . --config &lt;build_type&gt;</code> to decide the build type. The possible options are <code>Debug</code>, <code>Release</code>, <code>RelWithDebInfo</code> and <code>MinSizeRel</code>.</p>
<p>Replace <code>[OPTIONS]</code> with desired cmake options for your build. Ginkgo adds the following additional switches to control what is being built:</p>
<ul>
<li><code>-DGINKGO_DEVEL_TOOLS={ON, OFF}</code> sets up the build system for development (requires clang-format, will also download git-cmake-format), default is <code>ON</code>.</li>
<li><code>-DGINKGO_BUILD_TESTS={ON, OFF}</code> builds Ginkgo's tests (will download googletest), default is <code>ON</code>.</li>
<li><code>-DGINKGO_BUILD_BENCHMARKS={ON, OFF}</code> builds Ginkgo's benchmarks (will download gflags and rapidjson), default is <code>ON</code>.</li>
<li><code>-DGINKGO_BUILD_EXAMPLES={ON, OFF}</code> builds Ginkgo's examples, default is <code>ON</code></li>
<li><code>-DGINKGO_BUILD_EXTLIB_EXAMPLE={ON, OFF}</code> builds the interfacing example with deal.II, default is <code>OFF</code>.</li>
<li><code>-DGINKGO_BUILD_REFERENCE={ON, OFF}</code> build reference implementations of the kernels, useful for testing, default is <code>ON</code></li>
<li><code>-DGINKGO_BUILD_OMP={ON, OFF}</code> builds optimized OpenMP versions of the kernels, default is <code>OFF</code></li>
<li><code>-DGINKGO_BUILD_CUDA={ON, OFF}</code> builds optimized cuda versions of the kernels (requires CUDA), default is <code>OFF</code></li>
<li><code>-DGINKGO_BUILD_HIP={ON, OFF}</code> builds optimized HIP versions of the kernels (requires HIP), default is <code>OFF</code></li>
<li><code>-DGINKGO_HIP_AMDGPU="gpuarch1;gpuarch2"</code> the amdgpu_target(s) variable passed to hipcc for the <code>hcc</code> HIP backend. The default is none (auto).</li>
<li><code>-DGINKGO_BUILD_DOC={ON, OFF}</code> creates an HTML version of Ginkgo's documentation from inline comments in the code. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_DOC_GENERATE_EXAMPLES={ON, OFF}</code> generates the documentation of examples in Ginkgo. The default is <code>ON</code>.</li>
<li><code>-DGINKGO_DOC_GENERATE_PDF={ON, OFF}</code> generates a PDF version of Ginkgo's documentation from inline comments in the code. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_DOC_GENERATE_DEV={ON, OFF}</code> generates the developer version of Ginkgo's documentation. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_EXPORT_BUILD_DIR={ON, OFF}</code> adds the Ginkgo build directory to the CMake package registry. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_WITH_CLANG_TIDY={ON, OFF}</code> makes Ginkgo call <code>clang-tidy</code> to find programming issues. The path can be manually controlled with the CMake variable <code>-DGINKGO_CLANG_TIDY_PATH=&lt;path&gt;</code>. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_WITH_IWYU={ON, OFF}</code> makes Ginkgo call <code>iwyu</code> to find include issues. The path can be manually controlled with the CMake variable <code>-DGINKGO_IWYU_PATH=&lt;path&gt;</code>. The default is <code>OFF</code>.</li>
<li><code>-DGINKGO_VERBOSE_LEVEL=integer</code> sets the verbosity of Ginkgo.<ul>
<li><code>0</code> disables all output in the main libraries,</li>
<li><code>1</code> enables a few important messages related to unexpected behavior (default).</li>
</ul>
</li>
<li><code>-DCMAKE_INSTALL_PREFIX=path</code> sets the installation path for <code>make install</code>. The default value is usually something like <code>/usr/local</code>.</li>
<li><code>-DCMAKE_BUILD_TYPE=type</code> specifies which configuration will be used for this build of Ginkgo. The default is <code>RELEASE</code>. Supported values are CMake's standard build types such as <code>DEBUG</code> and <code>RELEASE</code> and the Ginkgo specific <code>COVERAGE</code>, <code>ASAN</code> (AddressSanitizer) and <code>TSAN</code> (ThreadSanitizer) types.</li>
<li><code>-DBUILD_SHARED_LIBS={ON, OFF}</code> builds ginkgo as shared libraries (<code>OFF</code>) or as dynamic libraries (<code>ON</code>), default is <code>ON</code>.</li>
<li><code>-DGINKGO_JACOBI_FULL_OPTIMIZATIONS={ON, OFF}</code> use all the optimizations for the CUDA Jacobi algorithm. <code>OFF</code> by default. Setting this option to <code>ON</code> may lead to very slow compile time (&gt;20 minutes) for the <code>jacobi_generate_kernels.cu</code> file and high memory usage.</li>
<li><code>-DCMAKE_CUDA_HOST_COMPILER=path</code> instructs the build system to explicitly set CUDA's host compiler to the path given as argument. By default, CUDA uses its toolchain's host compiler. Setting this option may help if you're experiencing linking errors due to ABI incompatibilities. This option is supported since <a href="https://github.com/Kitware/CMake/commit/489c52ce680df6439f9c1e553cd2925ca8944cb1">CMake 3.8</a> but <a href="https://cmake.org/cmake/help/v3.10/variable/CMAKE_CUDA_HOST_COMPILER.html">documented starting from 3.10</a>.</li>
<li><p class="startli"><code>-DGINKGO_CUDA_ARCHITECTURES=&lt;list&gt;</code> where <code>&lt;list&gt;</code> is a semicolon (<code>;</code>) separated list of architectures. Supported values are:</p><ul>
<li><code>Auto</code></li>
<li><code>Kepler</code>, <code>Maxwell</code>, <code>Pascal</code>, <code>Volta</code></li>
<li><code>CODE</code>, <code>CODE(COMPUTE)</code>, <code>(COMPUTE)</code></li>
</ul>
<p class="startli"><code>Auto</code> will automatically detect the present CUDA-enabled GPU architectures in the system. <code>Kepler</code>, <code>Maxwell</code>, <code>Pascal</code> and <code>Volta</code> will add flags for all architectures of that particular NVIDIA GPU generation. <code>COMPUTE</code> and <code>CODE</code> are placeholders that should be replaced with compute and code numbers (e.g. for <code>compute_70</code> and <code>sm_70</code> <code>COMPUTE</code> and <code>CODE</code> should be replaced with <code>70</code>. Default is <code>Auto</code>. For a more detailed explanation of this option see the <a href="https://github.com/ginkgo-project/CudaArchitectureSelector/blob/master/CudaArchitectureSelector.cmake#L58"><code>ARCHITECTURES</code> specification list</a> section in the documentation of the CudaArchitectureSelector CMake module.</p>
</li>
<li><code>-DGINKGO_WINDOWS_SHARED_LIBRARY_RELPATH=&lt;path&gt;</code> where &lt;path&gt; is a relative path built with <code>PROJECT_BINARY_DIR</code>. Users must add the absolute path (<code>PROJECT_BINARY_DIR</code>/<code>GINKGO_WINDOWS_SHARED_LIBRARY_RELPATH</code>) into the environment variable PATH when building shared libraries and executable program, default is <code>windows_shared_library</code>.</li>
<li><code>-DGINKGO_CHECK_PATH={ON, OFF}</code> checks if the environment variable PATH is valid. It is checked only when building shared libraries and executable program, default is <code>ON</code>.</li>
</ul>
<p>For example, to build everything (in debug mode), use:</p>
<div class="fragment"><div class="line">cmake  -G &quot;Unix Makefiles&quot; -H. -BDebug -DCMAKE_BUILD_TYPE=Debug -DGINKGO_DEVEL_TOOLS=ON \</div>
<div class="line">              -DGINKGO_BUILD_TESTS=ON -DGINKGO_BUILD_REFERENCE=ON -DGINKGO_BUILD_OMP=ON \</div>
<div class="line">              -DGINKGO_BUILD_CUDA=ON </div>
<div class="line">cmake --build Debug</div>
</div><!-- fragment --><p>NOTE: Ginkgo is known to work with the <code>Unix Makefiles</code> and <code>Ninja</code> based generators. Other CMake generators are untested.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Building Ginkgo with HIP support</h2>
<p>Ginkgo provides a <a href="https://github.com/ROCm-Developer-Tools/HIP">HIP</a> backend. This allows to compile optimized versions of the kernels for either AMD or NVIDIA GPUs. To build Ginkgo with this backend, use the CMake option <code>-DGINKGO_BUILD_HIP=ON</code>.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Correctly installing HIP toolkits and dependencies for Ginkgo</h3>
<p>In general, Ginkgo's HIP backend requires the following packages:</p><ul>
<li>HIP,</li>
<li>hipBLAS,</li>
<li>hipSPARSE,</li>
<li>Thrust.</li>
</ul>
<p>It is necessary to provide some details about the different ways to procure and install these packages, in particular for NVIDIA systems since getting a correct, non bloated setup is not straightforward.</p>
<p>For AMD systems, the simplest way is to follow the <a href="https://github.com/ROCm-Developer-Tools/HIP/blob/master/INSTALL.md">instructions provided here</a> which provide package installers for most Linux distributions. Ginkgo also needs the installation of the <a href="https://github.com/ROCmSoftwarePlatform/hipBLAS">hipBLAS</a> and <a href="https://github.com/ROCmSoftwarePlatform/hipSPARSE">hipSPARSE</a> interfaces. Optionally if you do not already have a thrust installation, [the ROCm provided rocThrust package can be used](<a href="https://github.com/ROCmSoftwarePlatform/rocThrust">https://github.com/ROCmSoftwarePlatform/rocThrust</a>).</p>
<p>For NVIDIA systems, the traditional installation (package <code>hip_nvcc</code>), albeit working properly is currently odd: it depends on all the <code>hcc</code> related packages, although the <code>nvcc</code> backend seems to entirely rely on the CUDA suite. [See this issue for more details](<a href="https://github.com/ROCmSoftwarePlatform/hipBLAS/issues/53">https://github.com/ROCmSoftwarePlatform/hipBLAS/issues/53</a>). It is advised in this case to compile everything manually, including using forks of <code>hipBLAS</code> and <code>hipSPARSE</code> specifically made to not depend on the <code>hcc</code> specific packages. <code>Thrust</code> is often provided by CUDA and this Thrust version should work with <code>HIP</code>. Here is a sample procedure for installing <code>HIP</code>, <code>hipBLAS</code> and <code>hipSPARSE</code>.</p>
<div class="fragment"><div class="line"># HIP</div>
<div class="line">git clone https://github.com/ROCm-Developer-Tools/HIP.git</div>
<div class="line">pushd HIP &amp;&amp; mkdir build &amp;&amp; pushd build</div>
<div class="line">cmake .. &amp;&amp; make install</div>
<div class="line">popd &amp;&amp; popd</div>
<div class="line"> </div>
<div class="line"># hipBLAS</div>
<div class="line">git clone https://github.com/tcojean/hipBLAS.git</div>
<div class="line">pushd hipBLAS &amp;&amp; mkdir build &amp;&amp; pushd build</div>
<div class="line">cmake .. &amp;&amp; make install</div>
<div class="line">popd &amp;&amp; popd</div>
<div class="line"> </div>
<div class="line"># hipSPARSE</div>
<div class="line">git clone https://github.com/tcojean/hipSPARSE.git</div>
<div class="line">pushd hipSPARSE &amp;&amp; mkdir build &amp;&amp; pushd build</div>
<div class="line">cmake -DBUILD_CUDA=ON .. &amp;&amp; make install</div>
<div class="line">popd &amp;&amp; popd</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3"></a>
Changing the paths to search for HIP and other packages</h3>
<p>All HIP installation paths can be configured through the use of environment variables or CMake variables. This way of configuring the paths is currently imposed by the <code>HIP</code> tool suite. The variables are the following:</p><ul>
<li>CMake <code>-DHIP_PATH=</code> or environment <code>export HIP_PATH=</code>: sets the <code>HIP</code> installation path. The default value is <code>/opt/rocm/hip</code>.</li>
<li>CMake <code>-DHIPBLAS_PATH=</code> or environment <code>export HIPBLAS_PATH=</code>: sets the <code>hipBLAS</code> installation path. The default value is <code>/opt/rocm/hipblas</code>.</li>
<li>CMake <code>-DHIPSPARSE_PATH=</code> or environment <code>export HIPSPARSE_PATH=</code>: sets the <code>hipSPARSE</code> installation path. The default value is <code>/opt/rocm/hipsparse</code>.</li>
<li>CMake <code>-DHCC_PATH=</code> or environment <code>export HCC_PATH=</code>: sets the <code>HCC</code> installation path, for AMD backends. The default value is <code>/opt/rocm/hcc</code>.</li>
<li>environment <code>export CUDA_PATH=</code>: where <code>hipcc</code> can find <code>CUDA</code> if it is not in the default <code>/usr/local/cuda</code> path.</li>
</ul>
<h3><a class="anchor" id="autotoc_md4"></a>
HIP platform detection of AMD and NVIDIA</h3>
<p>By default, Ginkgo uses the output of <code>/opt/rocm/hip/bin/hipconfig --platform</code> to select the backend. The accepted values are either <code>hcc</code> (AMD) or <code>nvcc</code> (NVIDIA). When on an AMD or NVIDIA system, this should output the correct platform by default. When on a system without GPUs, this should output <code>hcc</code> by default. To change this value, export the environment variable <code>HIP_PLATFORM</code> like so: </p><div class="fragment"><div class="line">export HIP_PLATFORM=nvcc</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md5"></a>
Setting platform specific compilation flags</h3>
<p>Platform specific compilation flags can be given through the following CMake variables:</p><ul>
<li><code>-DGINKGO_HIP_COMPILER_FLAGS=</code>: compilation flags given to all platforms.</li>
<li><code>-DGINKGO_HIP_HCC_COMPILER_FLAGS=</code>: compilation flags given to AMD platforms.</li>
<li><code>-DGINKGO_HIP_NVCC_COMPILER_FLAGS=</code>: compilation flags given to NVIDIA platforms.</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
Third party libraries and packages</h2>
<p>Ginkgo relies on third party packages in different cases. These third party packages can be turned off by disabling the relevant options.</p>
<ul>
<li>GINKGO_BUILD_CUDA=ON: <a href="https://github.com/ginkgo-project/CudaArchitectureSelector">CudaArchitectureSelector</a> (CAS) is a CMake helper to manage CUDA architecture settings;</li>
<li>GINKGO_BUILD_TESTS=ON: Our tests are implemented with <a href="https://github.com/google/googletest">Google Test</a>;</li>
<li>GINKGO_BUILD_BENCHMARKS=ON: For argument management we use <a href="https://github.com/gflags/gflags">gflags</a> and for JSON parsing we use <a href="https://github.com/Tencent/rapidjson">RapidJSON</a>;</li>
<li>GINKGO_DEVEL_TOOLS=ON: <a href="https://github.com/gflegar/git-cmake-format">git-cmake-format</a> is our CMake helper for code formatting.</li>
</ul>
<p>By default, Ginkgo uses the internal version of each package. For each of the packages <code>GTEST</code>, <code>GFLAGS</code>, <code>RAPIDJSON</code> and <code>CAS</code>, it is possible to force Ginkgo to try to use an external version of a package. For this, Ginkgo provides two ways to find packages. To rely on the CMake <code>find_package</code> command, use the CMake option <code>-DGINKGO_USE_EXTERNAL_&lt;package&gt;=ON</code>. Note that, if the external packages were not installed to the default location, the CMake option <code>-DCMAKE_PREFIX_PATH=&lt;path-list&gt;</code> needs to be set to the semicolon (<code>;</code>) separated list of install paths of these external packages. For more Information, see the <a href="https://cmake.org/cmake/help/v3.9/variable/CMAKE_PREFIX_PATH.html">CMake documentation for CMAKE_PREFIX_PATH</a> for details.</p>
<p>To manually configure the paths, Ginkgo relies on the <a href="https://xsdk.info/policies/">standard xSDK Installation policies</a> for all packages except <code>CAS</code> (as it is neither a library nor a header, it cannot be expressed through the <code>TPL</code> format):</p><ul>
<li><code>-DTPL_ENABLE_&lt;package&gt;=ON</code></li>
<li><code>-DTPL_&lt;package&gt;_LIBRARIES=/path/to/libraries.{so|a}</code></li>
<li><code>-DTPL_&lt;package&gt;_INCLUDE_DIRS=/path/to/header/directory</code></li>
</ul>
<p>When applicable (e.g. for <code>GTest</code> libraries), a <code>;</code> separated list can be given to the <code>TPL_&lt;package&gt;_{LIBRARIES|INCLUDE_DIRS}</code> variables.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Installing Ginkgo</h2>
<p>To install Ginkgo into the specified folder, execute the following command in the build folder</p>
<div class="fragment"><div class="line">make install</div>
</div><!-- fragment --><p>If the installation prefix (see <code>CMAKE_INSTALL_PREFIX</code>) is not writable for your user, e.g. when installing Ginkgo system-wide, it might be necessary to prefix the call with <code>sudo</code>.</p>
<p>After the installation, CMake can find ginkgo with <code>find_package(Ginkgo)</code>. An example can be found in the <a href="test_install/CMakeLists.txt"><code>test_install</code></a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
