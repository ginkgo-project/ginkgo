set(SOURCES
    base/executor.cpp
    base/mtx_io.cpp
    base/version.cpp
    log/logger.cpp
    log/record.cpp
    log/stream.cpp
    matrix/coo.cpp
    matrix/csr.cpp
    matrix/dense.cpp
    matrix/ell.cpp
    matrix/hybrid.cpp
    matrix/identity.cpp
    matrix/sellp.cpp
    preconditioner/block_jacobi.cpp
    solver/bicgstab.cpp
    solver/cg.cpp
    solver/cgs.cpp
    solver/fcg.cpp
    solver/gmres.cpp
    stop/combined.cpp
    stop/criterion.cpp
    stop/iteration.cpp
    stop/residual_norm_reduction.cpp
    stop/time.cpp)


add_subdirectory(devices)  # basic device functionalities, always compiled
add_subdirectory(device_hooks)  # placeholders for disabled modules

add_library(ginkgo ${SOURCES})
# add a namespace alias so Ginkgo can always be included as Ginkgo::ginkgo
# regardless of whether it is installed or added as a subdirectory
add_library(Ginkgo::ginkgo ALIAS ginkgo)
target_link_libraries(ginkgo
    PUBLIC ginkgo_omp ginkgo_cuda ginkgo_reference)
ginkgo_default_includes(ginkgo)
ginkgo_install_library(ginkgo core)

if(BUILD_TESTS)
    add_subdirectory(test)
endif()

